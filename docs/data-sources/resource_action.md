---
page_title: "msgraph_resource_action Data Source - terraform-provider-msgraph"
subcategory: ""
description: |-
  This data source can perform any Microsoft Graph API action and return the result. Use this for read-only operations like retrieving calculated values, checking status, or performing queries.
---

# msgraph_resource_action (Data Source)

This data source can perform any Microsoft Graph API action and return the result. Use this for read-only operations like retrieving calculated values, checking status, or performing queries.

## Example Usage

```terraform
terraform {
  required_providers {
    msgraph = {
      source = "Microsoft/msgraph"
    }
  }
}

provider "msgraph" {}

# Example 1: Get user's member groups
data "msgraph_resource_action" "user_member_groups" {
  resource_url = "users/john@example.com"
  action       = "getMemberGroups"
  method       = "POST"

  body = {
    securityEnabledOnly = false
  }

  response_export_values = {
    groups = "value"
  }
}

# Example 2: Check group membership
data "msgraph_resource_action" "check_membership" {
  resource_url = "users/john@example.com"
  action       = "checkMemberGroups"
  method       = "POST"

  body = {
    groupIds = [
      "{group-id-1}",
      "{group-id-2}"
    ]
  }

  response_export_values = {
    matched_groups = "value"
  }
}

# Example 3: Get group members with query parameters
data "msgraph_resource_action" "group_members" {
  resource_url = "groups/{group-id}"
  action       = "members"
  method       = "GET"

  query_parameters = {
    "$select" = ["id", "displayName", "userPrincipalName"]
    "$top"    = ["100"]
  }

  headers = {
    "ConsistencyLevel" = "eventual"
  }

  response_export_values = {
    members    = "value"
    member_ids = "value[].id"
    next_link  = "@odata.nextLink"
  }
}

# Example 4: Get application service principal
data "msgraph_resource_action" "app_service_principal" {
  resource_url = "applications/{application-id}"
  action       = "servicePrincipals"
  method       = "GET"

  query_parameters = {
    "$select" = ["id", "appId", "displayName"]
  }

  response_export_values = {
    service_principals = "value"
    sp_id              = "value[0].id"
  }
}

# Output the results
output "user_groups" {
  value = data.msgraph_resource_action.user_member_groups.output.groups
}

output "matched_groups" {
  value = data.msgraph_resource_action.check_membership.output.matched_groups
}

output "group_members" {
  value = data.msgraph_resource_action.group_members.output.members
}

output "service_principal_id" {
  value = data.msgraph_resource_action.app_service_principal.output.sp_id
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `resource_url` (String) The URL of the resource to perform the action on. This should be the full resource path, for example `applications/12345678-1234-1234-1234-123456789abc` or `users/user@example.com`. You can use the `resource_url` output from `msgraph_resource`.

### Optional

- `action` (String) The action to perform on the resource. This is the action path that will be appended to the resource URL, for example `getMemberGroups`, `checkMemberGroups`, `calculateDisplayNames`, or `members`. Leave empty for actions directly on the resource.
- `api_version` (String) The API version of the data source. The allowed values are `v1.0` and `beta`. Defaults to `v1.0`.
- `body` (Dynamic) A dynamic attribute that contains the request body.
- `headers` (Map of String) A mapping of HTTP headers to be sent with the action request. Note that authentication headers are automatically handled.
- `method` (String) The HTTP method to use for the action. For data sources, this is typically `GET` or `POST` for actions that require a request body.
- `query_parameters` (Map of List of String) A mapping of query parameters to be sent with the action request.
- `response_export_values` (Map of String) A map where the key is the name for the result and the value is a JMESPath query string to filter the response. Here's an example. If it sets to `{"all" = "@", "app_id" = "appId"}`, it will set the following HCL object to the computed property output.

	```text
	{
		"all" = {
			"appId" = "00000000-0000-0000-0000-000000000000"
			"displayName" = "example"
			"id" = "00000000-0000-0000-0000-000000000000"
			...
		}
		"app_id" = "00000000-0000-0000-0000-000000000000"
	}
	```

To learn more about JMESPath, visit [JMESPath](https://jmespath.org/).
- `retry` (Attributes) The retry object supports the following attributes: (see [below for nested schema](#nestedatt--retry))
- `timeouts` (Block, Optional) (see [below for nested schema](#nestedblock--timeouts))

### Read-Only

- `id` (String) The ID of the resource. Normally, it is in the format of UUID.
- `output` (Dynamic) The output HCL object containing the properties specified in `response_export_values`. Here are some examples to use the values.

	```terraform
	 output "app_id" {
	   // it will output the value of app_id
	   value = msgraph_resource.application.output.app_id
	 }
	 
	 output "all" {
	   // it will output the whole response
	   value = msgraph_resource.application.output.all
	 }
	```

<a id="nestedatt--retry"></a>
### Nested Schema for `retry`

Required:

- `error_message_regex` (List of String) A list of regular expressions to match against error messages. If any of the regular expressions match, the request will be retried.


<a id="nestedblock--timeouts"></a>
### Nested Schema for `timeouts`

Optional:

- `read` (String) A string that can be [parsed as a duration](https://pkg.go.dev/time#ParseDuration) consisting of numbers and unit suffixes, such as "30s" or "2h45m". Valid time units are "s" (seconds), "m" (minutes), "h" (hours). Read operations occur during any refresh or planning operation when refresh is enabled.
