---
page_title: "msgraph_resource_collection Resource - terraform-provider-msgraph"
subcategory: ""
description: |-
  Manage the full contents of a child reference collection (such as group members or owners) for an existing Microsoft Graph resource. Missing items are added; extra remote items are removed.
---

# msgraph_resource_collection (Resource)

Manage the full contents of a child reference collection (such as group members or owners) for an existing Microsoft Graph resource. Missing items are added; extra remote items are removed.

## Example Usage

 ```terraform
 terraform {
   required_providers {
     msgraph = {
       source = "Microsoft/msgraph"
     }
   }
 }
 
 provider "msgraph" {}
 
 resource "msgraph_resource" "application_a" {
   url = "applications"
   body = {
     displayName = "Collection Example App A"
   }
   response_export_values = {
     appId = "appId"
   }
 }
 
 resource "msgraph_resource" "sp_a" {
   url = "servicePrincipals"
   body = {
     appId = msgraph_resource.application_a.output.appId
   }
 }
 
 resource "msgraph_resource" "application_b" {
   url = "applications"
   body = {
     displayName = "Collection Example App B"
   }
   response_export_values = {
     appId = "appId"
   }
 }
 
 resource "msgraph_resource" "sp_b" {
   url = "servicePrincipals"
   body = {
     appId = msgraph_resource.application_b.output.appId
   }
 }
 
 resource "msgraph_resource" "group" {
   url = "groups"
   body = {
     displayName     = "Collection Example Group"
     mailEnabled     = false
     mailNickname    = "collection-example-group"
     securityEnabled = true
   }
 }
 
 resource "msgraph_resource_collection" "group_members" {
   url = "groups/${msgraph_resource.group.id}/members/$ref"
   // This API has a known issue where service principals are not listed as group members in v1.0. As a workaround, 
   // use this API on the beta endpoint or use the /groups/{id}?$expand=members API. For more information, 
   // see the related known issue: https://developer.microsoft.com/en-us/graph/known-issues/?search=25984
   api_version   = "beta"
   reference_ids = [msgraph_resource.sp_a.id, msgraph_resource.sp_b.id]
 }
 ```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `url` (String) Full relative path of the target reference collection ending in '/$ref'. For example: `groups/{group-id}/members/$ref`. This must point to a $ref collection; changing this value forces a new resource.

### Optional

- `api_version` (String) The API version of the data source. The allowed values are `v1.0` and `beta`. Defaults to `v1.0`.
- `read_query_parameters` (Map of List of String) A mapping of query parameters to be sent with the read (list) requests.
- `reference_ids` (List of String) List of object IDs that MUST exist in this `$ref` collection. Missing IDs are added; extra remote items are removed. Order is ignored. Each value should be the GUID (or string identifier) of an existing directory object (user, group, service principal, etc.).
- `response_export_values` (Map of String) A map where the key is the name for the result and the value is a JMESPath query string to filter the response. Here's an example. If it sets to `{"all" = "@", "app_id" = "appId"}`, it will set the following HCL object to the computed property output.

	```text
	{
		"all" = {
			"appId" = "00000000-0000-0000-0000-000000000000"
			"displayName" = "example"
			"id" = "00000000-0000-0000-0000-000000000000"
			...
		}
		"app_id" = "00000000-0000-0000-0000-000000000000"
	}
	```

To learn more about JMESPath, visit [JMESPath](https://jmespath.org/).
- `retry` (Attributes) The retry object supports the following attributes: (see [below for nested schema](#nestedatt--retry))
- `timeouts` (Block, Optional) (see [below for nested schema](#nestedblock--timeouts))

### Read-Only

- `id` (String) Identifier of this managed collection. This is the normalized collection URL with the trailing '/$ref' removed (e.g. for 'groups/{group-id}/members/$ref' the id becomes 'groups/{group-id}/members').
- `output` (Dynamic) The output HCL object containing the properties specified in `response_export_values`. Here are some examples to use the values.

	```terraform
	 output "app_id" {
	   // it will output the value of app_id
	   value = msgraph_resource.application.output.app_id
	 }
	 
	 output "all" {
	   // it will output the whole response
	   value = msgraph_resource.application.output.all
	 }
	```

<a id="nestedatt--retry"></a>
### Nested Schema for `retry`

Required:

- `error_message_regex` (List of String) A list of regular expressions to match against error messages. If any of the regular expressions match, the request will be retried.


<a id="nestedblock--timeouts"></a>
### Nested Schema for `timeouts`

Optional:

- `create` (String) A string that can be [parsed as a duration](https://pkg.go.dev/time#ParseDuration) consisting of numbers and unit suffixes, such as "30s" or "2h45m". Valid time units are "s" (seconds), "m" (minutes), "h" (hours).
- `delete` (String) A string that can be [parsed as a duration](https://pkg.go.dev/time#ParseDuration) consisting of numbers and unit suffixes, such as "30s" or "2h45m". Valid time units are "s" (seconds), "m" (minutes), "h" (hours). Setting a timeout for a Delete operation is only applicable if changes are saved into state before the destroy operation occurs.
- `read` (String) A string that can be [parsed as a duration](https://pkg.go.dev/time#ParseDuration) consisting of numbers and unit suffixes, such as "30s" or "2h45m". Valid time units are "s" (seconds), "m" (minutes), "h" (hours). Read operations occur during any refresh or planning operation when refresh is enabled.
- `update` (String) A string that can be [parsed as a duration](https://pkg.go.dev/time#ParseDuration) consisting of numbers and unit suffixes, such as "30s" or "2h45m". Valid time units are "s" (seconds), "m" (minutes), "h" (hours).


